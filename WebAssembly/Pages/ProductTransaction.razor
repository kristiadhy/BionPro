@page "/products/create"
@page "/products/edit"
@page "/products/edit/{ParamProductID:guid}"

<PageTitle>@($"{GlobalState.AppName} | {ProductPageModel?.Title}")</PageTitle>

<MainMenuContainer>
    <MainTransactionButton OnButtonBackClicked="EvBackToPrevious" />
</MainMenuContainer>

<RadzenRow Gap="0.5rem" RowGap="0.5rem">
    <RadzenColumn SizeLG="6" SizeMD="12" class="rz-pb-5">
        <RadzenCard class="my-2">
            <RadzenTemplateForm Data="@ProductState.Product" Submit="@(async (ProductDto args) => { await SubmitAsync(args); })">
                <FluentValidationValidator @ref="ProductValidator" />

                <RadzenFieldset Text="@FormHeaderText">
                    <RadzenStack Gap="1rem">
                        <ProductCategoryDropdown SelectedValueChanged="OnProductCategoryChanged" />

                        <RadzenTextBox Name="@nameof(ProductState.Product.Name)"
                                       Placeholder="Name"
                                       @bind-Value="ProductState.Product.Name"
                                       @ref="@txtNameForFocus" />

                        <RadzenTextBox Name="@nameof(ProductState.Product.SKU)"
                                       Placeholder="SKU"
                                       @bind-Value="ProductState.Product.SKU" />

                        <RadzenNumeric TValue="decimal"
                                       Format="c" @bind-Value="ProductState.Product.Price"
                                       Placeholder="Price"
                                       InputAttributes="@(new Dictionary<string,object>(){ { "aria-label", "enter value" }})" />

                        <RadzenUpload id="ddUpload"
                                      @ref="uploadDD"
                                      ChooseText="Drag and drop here or click to choose files"
                                      Auto="false"
                                      Multiple="true"
                                      Url="upload/multiple"
                                      InputAttributes="@(new Dictionary<string,object>(){ { "aria-label", "select file" }})"
                                      Progress=@(args => OnProgressUpload(args, "Drag and drop files to upload")) class="w-100" />
                        <RadzenButton Text="Upload" Click=@(args => uploadDD.Upload()) class="d-block mt-4" />

                        <RadzenTextArea Name="@nameof(ProductState.Product.Description)"
                                        Placeholder="Description"
                                        class="w-100"
                                        aria-label="TextArea"
                                        @bind-Value="ProductState.Product.Description" />
                    </RadzenStack>
                </RadzenFieldset>
                <ValidationSummary />

                <SaveTransactionButton OnButtonClear="ClearField"
                                       IsBusy="@IsSaving" />

            </RadzenTemplateForm>
        </RadzenCard>
    </RadzenColumn>
</RadzenRow>